library(caret)
library(randomForest)

CLASS.INDEX <- 30
# BASE.PATH <- "/home/xqiu/kdd/data/"
BASE.PATH <- "/host/kp/siat/KDD/ccf_contest/um/"

# train.feature <- read.table(paste(BASE.PATH,"TrainingFeatures",sep=""),sep=",")
train.feature <- read.table(paste(BASE.PATH,"trf",sep=""),sep=",")
CLASS.INDEX <-  ncol(train.feature)
# test.feature <- read.table(paste(BASE.PATH,"tef",sep=""),sep=",")
# test.desc <- test.feature[-CLASS.INDEX]
# test.class <- test.feature[CLASS.INDEX]
# rm(test.feature)
# zerovar <- nearZeroVar(test.desc)
# newdata1 <- test.desc[,-zerovar]
# rm(test.desc)
# 再删去相关度过高的自变量

train.col <- colnames(train.feature,prefix="")

two.features.col <- c("I ( V1*V2 )","I ( V1*V3 )","I ( V1*V4 )","I ( V1*V8 )","I ( V1*V9 )","I ( V1*V11 )","I ( V1*V17 )","I ( V1*V19 )","I ( V1*V20 )","I ( V1*V21 )","I ( V1*V27 )","I ( V1*V29 )","I ( V2*V2 )","I ( V2*V3 )","I ( V2*V4 )","I ( V2*V8 )","I ( V2*V9 )","I ( V2*V17 )","I ( V2*V20 )","I ( V2*V21 )","I ( V2*V27 )","I ( V2*V29 )","I ( V3*V3 )","I ( V3*V8 )","I ( V3*V9 )","I ( V3*V17 )","I ( V3*V19 )","I ( V3*V20 )","I ( V3*V21 )","I ( V3*V27 )","I ( V3*V29 )","I ( V4*V8 )","I ( V4*V9 )","I ( V4*V17 )","I ( V4*V20 )","I ( V4*V21 )","I ( V4*V27 )","I ( V4*V29 )","I ( V8*V8 )","I ( V9*V9 )","I ( V9*V21 )","I ( V17*V17 )","I ( V20*V20 )","I ( V21*V21 )","I ( V21*V27 )","I ( V27*V27 )","I ( V29*V29 )","I ( V19*V26 )","I ( V3*V12 )","I ( V13*V13 )","I ( V10*V11 )","I ( V19*V29 )","I ( V8*V18 )","I ( V8*V21 )","I ( V12*V1 )","I ( V3*V11 )","I ( V4*V13 )","I ( V1*V16 )","I ( V3*V13 )","I ( V2*V13 )","I ( V25*V25 )","I ( V1*V25 )","I ( V4*V24 )","I ( V15*V15 )","I ( V2*V16 )","I ( V4*V25 )","I ( V2*V11 )","I ( V2*V26 )","I ( V1*V14 )","I ( V4*V7 )","I ( V2*V2 )","I ( V2*V25 )","I ( V23*V23 )","I ( V3*V7 )","I ( V3*V10 )","I ( V23*V27 )","I ( V1*V6 )","I ( V4*V10 )","I ( V4*V23 )","I ( V3*V23 )","I ( V9*V20 )","I ( V7*V7 )","I ( V1*V23 )","I ( V19*V21 )","I ( V18*V19 )","I ( V4*V15 )","I ( V25*V29 )","I ( V3*V6 )","I ( V4*V11 )","I ( V20*V21 )","I ( V21*V29 )","I ( V4*V19 )","I ( V3*V15 )","I ( V3*V18 )","I ( V4*V4 )","I ( V22*V22 )","I ( V1*V10 )","I ( V1*V22 )","I ( V19*V25 )","I ( V2*V7 )","I ( V3*V16 )","I ( V3*V22 )","I ( V2*V14 )","I ( V1*V26 )","I ( V2*V24 )","I ( V10*V19 )","I ( V2*V6 )","I ( V2*V10 )","I ( V21*V25 )","I ( V26*V26 )","I ( V4*V26 )","I ( V11*V11 )","I ( V9*V19 )","I ( V1*V12 )","I ( V3*V24 )","I ( V6*V6 )","I ( V4*V22 )","I ( V4*V14 )","I ( V2*V18 )","I ( V9*V18 )","I ( V2*V19 )","I ( V14*V14 )","I ( V1*V1 )","I ( V2*V22 )","I ( V4*V16 )","I ( V16*V16 )","I ( V3*V14 )","I ( V3*V4 )","I ( V4*V6 )","I ( V1*V15 )","I ( V12*V28 )","I ( V11*V19 )","I ( V24*V24 )","I ( V19*V19 )","I ( V10*V10 )","I ( V2*V15 )","I ( V8*V12 )","I ( V8*V19 )","I ( V3*V25 )")

three.features.col <-c("I ( V1*V1*V1 ) " ,  "I ( V1*V1*V2 ) " ,  "I ( V1*V1*V3 ) " ,  "I ( V1*V1*V8 ) " ,  "I ( V1*V1*V9 ) " ,  "I ( V1*V1*V17 ) " ,  "I ( V1*V1*V20 ) " ,  "I ( V1*V1*V21 ) " ,  "I ( V1*V1*V27 ) " ,  "I ( V1*V1*V29 ) " ,  "I ( V1*V2*V2 ) " ,  "I ( V1*V2*V3 ) " ,  "I ( V1*V2*V4 ) " ,  "I ( V1*V2*V8 ) " ,  "I ( V1*V2*V9 ) " ,  "I ( V1*V2*V11 ) " ,  "I ( V1*V2*V17 ) " ,  "I ( V1*V2*V20 ) " ,  "I ( V1*V2*V21 ) " ,  "I ( V1*V2*V27 ) " ,  "I ( V1*V2*V29 ) " ,  "I ( V1*V3*V3 ) " ,  "I ( V1*V3*V4 ) " ,  "I ( V1*V3*V8 ) " ,  "I ( V1*V3*V9 ) " ,  "I ( V1*V3*V17 ) " ,  "I ( V1*V3*V19 ) " ,  "I ( V1*V3*V20 ) " ,  "I ( V1*V3*V21 ) " ,  "I ( V1*V3*V27 ) " ,  "I ( V1*V3*V29 ) " ,  "I ( V1*V4*V4 ) " ,  "I ( V1*V4*V8 ) " ,  "I ( V1*V4*V9 ) " ,  "I ( V1*V4*V11 ) " ,  "I ( V1*V4*V17 ) " ,  "I ( V1*V4*V19 ) " ,  "I ( V1*V4*V20 ) " ,  "I ( V1*V4*V21 ) " ,  "I ( V1*V4*V27 ) " ,  "I ( V1*V4*V29 ) " ,  "I ( V1*V8*V8 ) " ,  "I ( V1*V9*V9 ) " ,  "I ( V1*V9*V21 ) " ,  "I ( V1*V11*V11 ) " ,  "I ( V1*V17*V17 ) " ,  "I ( V1*V19*V19 ) " ,  "I ( V1*V19*V27 ) " ,  "I ( V1*V20*V20 ) " ,  "I ( V1*V21*V21 ) " ,  "I ( V1*V21*V27 ) " ,  "I ( V1*V27*V27 ) " ,  "I ( V1*V29*V29 ) " ,  "I ( V2*V2*V2 ) " ,  "I ( V2*V2*V3 ) " ,  "I ( V2*V2*V4 ) " ,  "I ( V2*V2*V8 ) " ,  "I ( V2*V2*V9 ) " ,  "I ( V2*V2*V17 ) " ,  "I ( V2*V2*V20 ) " ,  "I ( V2*V2*V21 ) " ,  "I ( V2*V2*V27 ) " ,  "I ( V2*V2*V29 ) " ,  "I ( V2*V3*V4 ) " ,  "I ( V2*V3*V8 ) " ,  "I ( V2*V3*V9 ) " ,  "I ( V2*V3*V17 ) " ,  "I ( V2*V3*V20 ) " ,  "I ( V2*V3*V21 ) " ,  "I ( V2*V3*V27 ) " ,  "I ( V2*V3*V29 ) " ,  "I ( V2*V4*V4 ) " ,  "I ( V2*V4*V8 ) " ,  "I ( V2*V4*V9 ) " ,  "I ( V2*V4*V17 ) " ,  "I ( V2*V4*V20 ) " ,  "I ( V2*V4*V21 ) " ,  "I ( V2*V4*V27 ) " ,  "I ( V2*V4*V29 ) " ,  "I ( V2*V8*V8 ) " ,  "I ( V2*V9*V9 ) " ,  "I ( V2*V9*V21 ) " ,  "I ( V2*V17*V17 ) " ,  "I ( V2*V20*V20 ) " ,  "I ( V2*V21*V21 ) " ,  "I ( V2*V21*V27 ) " ,  "I ( V2*V27*V27 ) " ,  "I ( V2*V29*V29 ) " ,  "I ( V3*V3*V3 ) " ,  "I ( V3*V3*V8 ) " ,  "I ( V3*V3*V9 ) " ,  "I ( V3*V3*V17 ) " ,  "I ( V3*V3*V20 ) " ,  "I ( V3*V3*V21 ) " ,  "I ( V3*V3*V27 ) " ,  "I ( V3*V3*V29 ) " ,  "I ( V3*V4*V8 ) " ,  "I ( V3*V4*V9 ) " ,  "I ( V3*V4*V17 ) " ,  "I ( V3*V4*V20 ) " ,  "I ( V3*V4*V21 ) " ,  "I ( V3*V4*V27 ) " ,  "I ( V3*V4*V29 ) " ,  "I ( V3*V8*V8 ) " ,  "I ( V3*V9*V9 ) " ,  "I ( V3*V9*V21 ) " ,  "I ( V3*V17*V17 ) " ,  "I ( V3*V19*V19 ) " ,  "I ( V3*V20*V20 ) " ,  "I ( V3*V21*V21 ) " ,  "I ( V3*V21*V27 ) " ,  "I ( V3*V27*V27 ) " ,  "I ( V3*V29*V29 ) " ,  "I ( V4*V4*V8 ) " ,  "I ( V4*V4*V9 ) " ,  "I ( V4*V4*V17 ) " ,  "I ( V4*V4*V20 ) " ,  "I ( V4*V4*V21 ) " ,  "I ( V4*V4*V27 ) " ,  "I ( V4*V4*V29 ) " ,  "I ( V4*V8*V8 ) " ,  "I ( V4*V9*V9 ) " ,  "I ( V4*V9*V21 ) " ,  "I ( V4*V17*V17 ) " ,  "I ( V4*V20*V20 ) " ,  "I ( V4*V21*V21 ) " ,  "I ( V4*V21*V27 ) " ,  "I ( V4*V27*V27 ) " ,  "I ( V4*V29*V29 ) " ,  "I ( V8*V8*V8 ) " ,  "I ( V9*V9*V9 ) " ,  "I ( V9*V9*V21 ) " ,  "I ( V9*V21*V21 ) " ,  "I ( V17*V17*V17 ) " ,  "I ( V19*V21*V27 ) " ,  "I ( V20*V20*V20 ) " ,  "I ( V21*V21*V21 ) " ,  "I ( V21*V21*V27 ) " ,  "I ( V21*V27*V27 ) " ,  "I ( V27*V27*V27 ) " ,  "I ( V29*V29*V29 ) " ,  "I ( V2*V12*V28 ) " ,  "I ( V4*V4*V26 ) " ,  "I ( V4*V19*V26 ) " ,  "I ( V1*V2*V15 ) " ,  "I ( V1*V15*V15 ) " ,  "I ( V4*V20*V21 ) " ,  "I ( V8*V8*V18 ) " ,  "I ( V8*V8*V21 ) " ,  "I ( V8*V18*V18 ) " ,  "I ( V8*V18*V19 ) " ,  "I ( V8*V18*V21 ) " ,  "I ( V8*V19*V21 ) " ,  "I ( V8*V21*V21 ) " ,  "I ( V9*V19*V21 ) " ,  "I ( V3*V11*V11 ) " ,  "I ( V4*V8*V19 ) " ,  "I ( V10*V10*V11 ) " ,  "I ( V10*V11*V11 ) " ,  "I ( V10*V11*V19 ) " ,  "I ( V4*V13*V13 ) " ,  "I ( V4*V12*V28 ) " ,  "I ( V4*V8*V18 ) " ,  "I ( V4*V8*V21 ) " ,  "I ( V2*V10*V11 ) " ,  "I ( V3*V13*V13 ) " ,  "I ( V1*V9*V18 ) " ,  "I ( V9*V9*V18 ) " ,  "I ( V9*V18*V18 ) " ,  "I ( V9*V18*V19 ) " ,  "I ( V9*V18*V21 ) " ,  "I ( V2*V4*V10 ) " ,  "I ( V2*V9*V18 ) " ,  "I ( V19*V19*V29 ) " ,  "I ( V19*V29*V29 ) " ,  "I ( V2*V19*V29 ) " ,  "I ( V3*V4*V12 ) " ,  "I ( V3*V10*V11 ) " ,  "I ( V4*V9*V18 ) " ,  "I ( V2*V8*V19 ) " ,  "I ( V1*V8*V19 ) " ,  "I ( V1*V20*V21 ) " ,  "I ( V1*V8*V18 ) " ,  "I ( V1*V8*V21 ) " ,  "I ( V2*V8*V18 ) " ,  "I ( V2*V8*V21 ) " ,  "I ( V12*V12*V28 ) " ,  "I ( V12*V28*V28 ) " ,  "I ( V1*V4*V15 ) " ,  "I ( V4*V19*V29 ) " ,  "I ( V3*V19*V29 ) " ,  "I ( V3*V8*V19 ) " ,  "I ( V1*V2*V16 ) " ,  "I ( V3*V4*V13 ) " ,  "I ( V3*V20*V21 ) " ,  "I ( V3*V8*V18 ) " ,  "I ( V3*V8*V21 ) " ,  "I ( V1*V3*V26 ) " ,  "I ( V13*V13*V13 ) " ,  "I ( V4*V19*V19 ) " ,  "I ( V3*V18*V18 ) " ,  "I ( V1*V25*V25 ) " ,  "I ( V2*V2*V18 ) " ,  "I ( V3*V21*V29 ) " ,  "I ( V4*V18*V19 ) " ,  "I ( V2*V4*V11 ) " ,  "I ( V1*V4*V22 ) " ,  "I ( V1*V1*V13 ) " ,  "I ( V3*V8*V12 ) " ,  "I ( V4*V19*V25 ) " ,  "I ( V1*V12*V28 ) " ,  "I ( V3*V3*V16 ) " ,  "I ( V1*V2*V23 ) " ,  "I ( V3*V4*V23 ) " ,  "I ( V1*V3*V10 ) " ,  "I ( V2*V3*V10 ) " ,  "I ( V2*V3*V15 ) " ,  "I ( V1*V1*V16 ) " ,  "I ( V3*V3*V22 ) " ,  "I ( V1*V9*V19 ) " ,  "I ( V1*V2*V14 ) " ,  "I ( V1*V1*V26 ) " ,  "I ( V1*V25*V29 ) " ,  "I ( V4*V19*V21 ) " ,  "I ( V4*V4*V10 ) " ,  "I ( V2*V4*V6 ) " ,  "I ( V3*V25*V29 ) " ,  "I ( V4*V4*V11 ) " ,  "I ( V3*V24*V24 ) " ,  "I ( V3*V4*V15 ) " ,  "I ( V1*V2*V12 ) " ,  "I ( V3*V3*V19 ) " ,  "I ( V1*V1*V4 ) " ,  "I ( V4*V7*V7 ) " ,  "I ( V1*V1*V24 ) " ,  "I ( V11*V11*V19 ) " ,  "I ( V11*V19*V19 ) " ,  "I ( V2*V4*V22 ) " ,  "I ( V4*V10*V19 ) " ,  "I ( V1*V23*V23 ) " ,  "I ( V3*V3*V11 ) " ,  "I ( V4*V4*V25 ) " ,  "I ( V2*V3*V14 ) " ,  "I ( V2*V23*V27 ) " ,  "I ( V26*V26*V26 ) " ,  "I ( V4*V22*V22 ) " ,  "I ( V3*V3*V12 ) " ,  "I ( V1*V2*V26 ) " ,  "I ( V2*V2*V25 ) " ,  "I ( V21*V21*V29 ) " ,  "I ( V21*V25*V29 ) " ,  "I ( V21*V29*V29 ) " ,  "I ( V3*V3*V4 ) " ,  "I ( V19*V19*V19 ) " ,  "I ( V2*V3*V18 ) " ,  "I ( V3*V3*V7 ) " ,  "I ( V3*V4*V6 ) " ,  "I ( V1*V18*V19 ) " ,  "I ( V1*V12*V12 ) " ,  "I ( V3*V4*V7 ) " ,  "I ( V4*V4*V22 ) " ,  "I ( V1*V3*V22 ) " ,  "I ( V18*V18*V19 ) " ,  "I ( V18*V19*V19 ) " ,  "I ( V3*V4*V14 ) " ,  "I ( V1*V3*V14 ) " ,  "I ( V12*V12*V12 ) " ,  "I ( V14*V14*V14 ) " ,  "I ( V3*V4*V18 ) " ,  "I ( V1*V3*V6 ) " ,  "I ( V3*V3*V15 ) " ,  "I ( V2*V2*V22 ) " ,  "I ( V3*V19*V26 ) " ,  "I ( V2*V3*V23 ) " ,  "I ( V3*V21*V25 ) " ,  "I ( V2*V2*V19 ) " ,  "I ( V1*V1*V22 ) " ,  "I ( V1*V3*V25 ) " ,  "I ( V22*V22*V22 ) " ,  "I ( V2*V7*V7 ) " ,  "I ( V1*V4*V10 ) " ,  "I ( V1*V1*V19 ) " ,  "I ( V19*V19*V26 ) " ,  "I ( V19*V26*V26 ) " ,  "I ( V2*V26*V26 ) " ,  "I ( V3*V3*V24 ) " ,  "I ( V3*V3*V14 ) " ,  "I ( V3*V4*V22 ) " ,  "I ( V4*V4*V19 ) " ,  "I ( V2*V11*V19 ) " ,  "I ( V1*V9*V20 ) " ,  "I ( V1*V1*V11 ) " ,  "I ( V2*V4*V23 ) " ,  "I ( V2*V4*V26 ) " ,  "I ( V2*V6*V6 ) " ,  "I ( V3*V3*V6 ) " ,  "I ( V3*V4*V19 ) " ,  "I ( V11*V11*V11 ) " ,  "I ( V2*V2*V15 ) " ,  "I ( V3*V19*V21 ) " ,  "I ( V4*V6*V6 ) " ,  "I ( V4*V4*V15 ) " ,  "I ( V1*V2*V22 ) " ,  "I ( V15*V15*V15 ) " ,  "I ( V3*V10*V19 ) " ,  "I ( V4*V4*V23 ) " ,  "I ( V24*V24*V24 ) " ,  "I ( V3*V4*V10 ) " ,  "I ( V2*V25*V29 ) " ,  "I ( V1*V3*V12 ) " ,  "I ( V3*V18*V21 ) " ,  "I ( V2*V4*V7 ) " ,  "I ( V1*V21*V29 ) " ,  "I ( V2*V2*V26 ) " ,  "I ( V1*V1*V12 ) " ,  "I ( V2*V4*V18 ) " ,  "I ( V3*V23*V27 ) " ,  "I ( V1*V11*V19 ) " ,  "I ( V4*V25*V25 ) " ,  "I ( V1*V4*V14 ) " ,  "I ( V2*V18*V18 ) " ,  "I ( V7*V7*V7 ) " ,  "I ( V2*V2*V7 ) " ,  "I ( V1*V22*V22 ) " ,  "I ( V4*V4*V6 ) " ,  "I ( V4*V26*V26 ) " ,  "I ( V3*V10*V10 ) " ,  "I ( V3*V4*V16 ) " ,  "I ( V4*V4*V7 ) " ,  "I ( V2*V3*V19 ) " ,  "I ( V2*V16*V16 ) " ,  "I ( V2*V2*V14 ) " ,  "I ( V2*V22*V22 ) " ,  "I ( V1*V3*V18 ) " ,  "I ( V3*V4*V11 ) " ,  "I ( V2*V9*V19 ) " ,  "I ( V3*V15*V15 ) " ,  "I ( V1*V1*V6 ) " ,  "I ( V2*V9*V20 ) " ,  "I ( V2*V19*V25 ) " ,  "I ( V2*V3*V16 ) " ,  "I ( V4*V21*V29 ) " ,  "I ( V3*V11*V19 ) " ,  "I ( V1*V1*V7 ) " ,  "I ( V8*V8*V12 ) " ,  "I ( V8*V12*V12 ) " ,  "I ( V2*V8*V12 ) " ,  "I ( V2*V24*V24 ) " ,  "I ( V4*V21*V25 ) " ,  "I ( V10*V10*V19 ) " ,  "I ( V10*V19*V19 ) " ,  "I ( V2*V4*V15 ) " ,  "I ( V1*V2*V18 ) " ,  "I ( V2*V19*V21 ) " ,  "I ( V2*V10*V10 ) " ,  "I ( V4*V25*V29 ) " ,  "I ( V1*V1*V23 ) " ,  "I ( V23*V23*V23 ) " ,  "I ( V2*V21*V29 ) " ,  "I ( V3*V23*V23 ) " ,  "I ( V1*V3*V11 ) " ,  "I ( V19*V21*V25 ) " ,  "I ( V1*V26*V26 ) " ,  "I ( V1*V4*V12 ) " ,  "I ( V4*V19*V27 ) " ,  "I ( V3*V16*V16 ) " ,  "I ( V3*V3*V10 ) " ,  "I ( V2*V3*V25 ) " ,  "I ( V1*V1*V15 ) " ,  "I ( V2*V19*V19 ) " ,  "I ( V2*V23*V23 ) " ,  "I ( V1*V19*V25 ) " ,  "I ( V3*V9*V20 ) " ,  "I ( V2*V18*V19 ) " ,  "I ( V2*V2*V6 ) " ,  "I ( V16*V16*V16 ) " ,  "I ( V1*V1*V14 ) " ,  "I ( V2*V2*V11 ) " ,  "I ( V3*V7*V7 ) " ,  "I ( V3*V6*V6 ) " ,  "I ( V1*V21*V25 ) " ,  "I ( V3*V4*V24 ) " ,  "I ( V2*V25*V25 ) " ,  "I ( V2*V3*V24 ) " ,  "I ( V1*V19*V21 ) " ,  "I ( V1*V1*V25 ) " ,  "I ( V3*V18*V19 ) " ,  "I ( V4*V14*V14 ) " ,  "I ( V3*V4*V25 ) " ,  "I ( V4*V11*V11 ) " ,  "I ( V4*V15*V15 ) " ,  "I ( V2*V15*V15 ) " ,  "I ( V4*V16*V16 ) " ,  "I ( V1*V2*V6 ) " ,  "I ( V2*V4*V25 ) " ,  "I ( V3*V12*V12 ) " ,  "I ( V3*V9*V19 ) " ,  "I ( V2*V3*V7 ) " ,  "I ( V3*V14*V14 ) " ,  "I ( V1*V2*V19 ) " ,  "I ( V2*V11*V11 ) " ,  "I ( V4*V4*V24 ) " ,  "I ( V2*V19*V27 ) " ,  "I ( V2*V2*V24 ) " ,  "I ( V1*V2*V25 ) " ,  "I ( V2*V4*V14 ) " ,  "I ( V4*V11*V19 ) " ,  "I ( V2*V18*V21 ) " ,  "I ( V6*V6*V6 ) " ,  "I ( V2*V4*V16 ) " ,  "I ( V1*V23*V27 ) " ,  "I ( V23*V23*V27 ) " ,  "I ( V23*V27*V27 ) " ,  "I ( V4*V10*V10 ) " ,  "I ( V25*V25*V25 ) " ,  "I ( V4*V4*V16 ) " ,  "I ( V2*V3*V26 ) " ,  "I ( V4*V24*V24 ) " ,  "I ( V10*V10*V10 ) " ,  "I ( V1*V10*V19 ) " ,  "I ( V2*V2*V16 ) " ,  "I ( V3*V4*V4 ) " ,  "I ( V9*V20*V21 ) " ,  "I ( V20*V20*V21 ) " ,  "I ( V20*V21*V21 ) " ,  "I ( V4*V4*V14 ) " ,  "I ( V1*V4*V6 ) " ,  "I ( V2*V10*V19 ) " ,  "I ( V2*V20*V21 ) " ,  "I ( V18*V19*V21 ) " ,  "I ( V4*V9*V19 ) " ,  "I ( V2*V21*V25 ) " ,  "I ( V19*V19*V21 ) " ,  "I ( V19*V21*V21 ) " ,  "I ( V4*V23*V23 ) " ,  "I ( V9*V9*V20 ) " ,  "I ( V9*V20*V20 ) " ,  "I ( V2*V3*V22 ) " ,  "I ( V19*V19*V25 ) " ,  "I ( V19*V25*V25 ) " ,  "I ( V4*V23*V27 ) " ,  "I ( V21*V21*V25 ) " ,  "I ( V21*V25*V25 ) " ,  "I ( V9*V9*V19 ) " ,  "I ( V9*V19*V19 ) " ,  "I ( V2*V14*V14 ) " ,  "I ( V1*V2*V10 ) " ,  "I ( V3*V3*V23 ) " ,  "I ( V1*V10*V10 ) " ,  "I ( V4*V4*V4 ) " ,  "I ( V2*V2*V2 ) " ,  "I ( V4*V9*V20 ) " ,  "I ( V1*V6*V6 ) " ,  "I ( V8*V8*V19 ) " ,  "I ( V8*V19*V19 ) " ,  "I ( V2*V3*V6 ) " ,  "I ( V4*V8*V12 ) " ,  "I ( V2*V4*V24 ) " ,  "I ( V3*V19*V25 ) " ,  "I ( V3*V25*V25 ) " ,  "I ( V1*V3*V23 ) " ,  "I ( V1*V4*V26 ) " ,  "I ( V3*V3*V18 ) " ,  "I ( V1*V1*V10 ) " ,  "I ( V3*V22*V22 ) " ,  "I ( V25*V25*V29 ) " ,  "I ( V25*V29*V29 ) " ,  "I ( V1*V14*V14 ) " ,  "I ( V1*V4*V25 ) " ,  "I ( V1*V4*V23 ) " )

all.features.col <- c(train.col,two.features.col)
#然后获得一般线性模型结果
fmla <- as.formula(paste(all.features.col[CLASS.INDEX], "~",paste(all.features.col[-CLASS.INDEX], collapse= "+")))


# 数据预处理步骤（标准化，缺失值处理）
# Process <- preProcess(train.feature[,-CLASS.INDEX])
# newdata <- predict(Process, train.feature[,-CLASS.INDEX])
# 用sbf函数实施过滤方法，这里是用随机森林来评价变量的重要性
data.filter <- sbf(fmla,train.feature,
                   sbfControl = sbfControl(functions=rfSBF,
                                           verbose=F,
                                           method='cv'))

write.table(as.data.frame(data.filter$optVariables),p,paste(BASE.PATH,"optVariables",sep=""),sep="\t",
            quote = FALSE,row.names = FALSE,col.names=FALSE)
# 根据上面的过滤器筛选出67个变量
x <- newdata[data.filter$optVariables]
# 再用rfe函数实施封装方法，建立的模型仍是随机森林
profile <- rfe(x,train.feature[,CLASS.INDEX],
               sizes = c(10,20,30,50,60),
               rfeControl = rfeControl(functions=rfFuncs
                                       ,method='cv'))
# 将结果绘图，发现20-30个变量的模型精度最高
plot(profile,type=c('o','g'))

# if(length(highCorr)!=0){
#   newdata2 <<- test.feature[, -highCorr]
# }else{
#   newdata2 <<- test.feature
# }
# 
# # 数据预处理步骤（标准化，缺失值处理）
# Process <- preProcess(newdata2)
# newdata3 <- predict(Process, newdata2)
# # 用sbf函数实施过滤方法，这里是用随机森林来评价变量的重要性
# data.filter <- sbf(newdata3,test.class,
#                    sbfControl = sbfControl(functions=rfSBF,
#                                            verbose=F,
#                                            method='cv'))
# # 根据上面的过滤器筛选出67个变量
# x <- newdata3[data.filter$optVariables]
# # 再用rfe函数实施封装方法，建立的模型仍是随机森林
# profile <- rfe(x,test.class,
#                sizes = c(10,20,30,50,60),
#                rfeControl = rfeControl(functions=rfFuncs
#                                        ,method='cv'))
# # 将结果绘图，发现20-30个变量的模型精度最高
# plot(profile,type=c('o','g'))